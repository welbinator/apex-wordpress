/*!
 * 
 * Presto Player
 * 
 * @author Presto Made, Inc
 * @version 0.1.0
 * @link undefined
 * @license GPL
 * 
 * Copyright (c) 2021 Presto Made, Inc
 * 
 * This software is released under the GPL License
 * https://opensource.org/licenses/GPL
 * 
 * Compiled with the help of https://wpack.io
 * A zero setup Webpack Bundler Script for WordPress
 */
(window.wpackioprestoPlayerdiviJsonp=window.wpackioprestoPlayerdiviJsonp||[]).push([[0],{0:function(e,t){e.exports=React},25:function(e,t){e.exports=ReactDOM},35:function(e,t){e.exports=jQuery},39:function(e,t,n){n(40),e.exports=n(55)},55:function(e,t,n){"use strict";n.r(t);var r=n(35),o=n.n(r),a=n(5),c=n(8),i=n(6),s=n(19),u=n(12),l=n(4),p=n(0),f=n.n(p),d=n(26),h=n(18),b=n(20),v=n.n(b),m=function(e){return e.replace(/([A-Z])/g,(function(e){return"-".concat(e[0].toLowerCase())}))},y=n(9),O=function(e,t,n){var r=t.className||t.class,o=n.className||n.class,a=_(e),c=_(r?r.split(" "):[]),i=_(o?o.split(" "):[]),s=[];return a.forEach((function(e){c.has(e)?(s.push(e),c.delete(e)):i.has(e)||s.push(e)})),c.forEach((function(e){return s.push(e)})),s.join(" ")},j=function(e,t){var n="on"+e,r=n in t;if(!r){var o=t.createElement("div");o.setAttribute(n,"return;"),r="function"==typeof o[n]}return r},w=function(e,t,n){var r=e.__events||(e.__events={}),o=r[t];o&&e.removeEventListener(t,o),e.addEventListener(t,r[t]=function(e){n&&n.call(this,e)})},_=function(e){var t=new Map;return e.forEach((function(e){return t.set(e,e)})),t},E=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.forEach((function(t){"function"==typeof t?t(e):null!=t&&(t.current=e)}))}};function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var o=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var C=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},k=function(e,t,n){var r=e.toLowerCase().split("-").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(""),o=function(t){Object(i.a)(s,t);var o=g(s);function s(e){var t;return Object(a.a)(this,s),(t=o.call(this,e)).setComponentElRef=function(e){t.componentEl=e},t}return Object(c.a)(s,[{key:"componentDidMount",value:function(){this.componentDidUpdate(this.props)}},{key:"componentDidUpdate",value:function(e){!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e instanceof Element){var r=O(e.classList,t,n);""!==r&&(e.className=r),Object.keys(t).forEach((function(n){if("children"!==n&&"style"!==n&&"ref"!==n&&"class"!==n&&"className"!==n&&"forwardedRef"!==n)if(0===n.indexOf("on")&&n[2]===n[2].toUpperCase()){var r=n.substring(2),o=r[0].toLowerCase()+r.substring(1);"undefined"==typeof document||j(o,document)||w(e,o,t[n])}else{e[n]=t[n],"string"===Object(y.a)(t[n])?e.setAttribute(m(n),t[n]):e[n]=t[n]}}))}}(this.componentEl,this.props,e)}},{key:"render",value:function(){var t=this.props,r=t.children,o=t.forwardedRef,a=t.style,c=(t.className,t.ref,C(t,["children","forwardedRef","style","className","ref"])),i=Object.keys(c).reduce((function(e,t){if(0===t.indexOf("on")&&t[2]===t[2].toUpperCase()){var n=t.substring(2).toLowerCase();"undefined"!=typeof document&&j(n,document)&&(e[t]=c[t])}else e[t]=c[t];return e}),{});n&&(i=n(this.props,i));var s=Object.assign(Object.assign({},i),{ref:E(o,this.setComponentElRef),style:a});return f.a.createElement(e,s,r)}}],[{key:"displayName",get:function(){return r}}]),s}(f.a.Component);return t&&(o.contextType=t),function(e,t){var n=function(t,n){return f.a.createElement(e,Object.assign({},t,{forwardedRef:n}))};return n.displayName=t,f.a.forwardRef(n)}(o,r)},R=k("presto-player");var x=function(e){var t=e.id,n=e.src,r=Object(p.useState)({}),o=Object(h.a)(r,2),a=o[0],c=o[1],i=Object(p.useState)(!1),s=Object(h.a)(i,2),u=s[0],l=s[1],b=Object(p.useState)("self-hosted"),m=Object(h.a)(b,2),y=m[0],O=m[1],j=Object(p.useState)(1),w=Object(h.a)(j,2),_=w[0],E=w[1];Object(p.useEffect)((function(){E(_+1)}),[t,n,a]),Object(p.useEffect)((function(){g(t)}),[t]),Object(p.useEffect)((function(){O(function(e){if(e){if(e.match(/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/))return"youtube";if(e.match(/(https?:\/\/)?(www\.)?(player\.)?vimeo\.com\/([a-z]*\/)*([‌​0-9]{6,11})[?]?.*/))return"vimeo";if(e.indexOf("https://vz-")>-1&&e.indexOf("b-cdn.net")>-1)return"bunny"}return"self-hosted"}(n))}),[n]);var g=function(){var e=Object(d.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return l(!0),e.prev=3,e.next=6,fetch("/wp-admin/admin-ajax.php",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded","Cache-Control":"no-cache"},body:new URLSearchParams({action:"presto_get_media_attributes",_wpnonce:window.et_fb_options.et_admin_load_nonce,id:t})}).then((function(e){return e.json()}));case 6:n=e.sent,c(n.data);case 8:return e.prev=8,l(!1),e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[3,,8,11]])})));return function(t){return e.apply(this,arguments)}}();return u?f.a.createElement("div",{className:"et-fb-preloader et-fb-preloader__loading"},f.a.createElement("div",{className:"et-fb-loader"})):a.id?(n=n||a.src,"bunny"!==(null==a?void 0:a.provider)||"self-hosted"!==y&&"bunny"!==y?f.a.createElement(R,{key:_,video_id:a.id,preset:a.preset,src:n,chapters:a.chapters,tracks:a.tracks,branding:a.branding,blockAttributes:a.blockAttributes,config:a.config,skin:a.skin,analytics:a.analytics,automations:a.automations,provider:y,provider_video_id:a.provider_video_id,youtube:a.youtube}):f.a.createElement("presto-video-curtain-ui",null,f.a.createElement("span",null,"Bunny.net videos cannot be previewed in the DIVI editor due to DIVI iframe having no referrer."),f.a.createElement("presto-player-button",{full:!0,type:"primary",target:"_blank",href:"https://prestoplayer.com/docs/bunny-net-videos-not-showing-in-divi-editor"},"Learn More"))):"Choose A Video"};function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var o=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var V=wp.i18n.__,S=function(e){Object(i.a)(n,e);var t=P(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).state={videos:[]},r}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props.dynamic.url_override;return this.props.video_id?f.a.createElement(x,{id:this.props.video_id,src:e&&e.value&&e.value}):f.a.createElement("presto-video-curtain-ui",null,f.a.createElement("span",null,V("Please select a video.","presto-player")))}}]),n}(p.Component);Object(l.a)(S,"slug","prpl_presto_player");var L=[S],N=n(10),D=n(16),I=n(15),T=n(38),A=n(36),U=n(37),B=n.n(U);function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function J(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var o=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var F=wp.i18n.__,Q=function(e){Object(i.a)(n,e);var t=J(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return e=t.call.apply(t,[this].concat(o)),Object(l.a)(Object(N.a)(e),"createEmotionCacheCustom",(function(e){return Object(D.a)({nonce:e,key:"custom-select-style",container:this.props.container})})),Object(l.a)(Object(N.a)(e),"createEmotionCache",Object(I.a)(e.createEmotionCacheCustom)),e}return n}(T.a),Z=function(e){Object(i.a)(n,e);var t=J(n);function n(e){var r;Object(a.a)(this,n),r=t.call(this,e),Object(l.a)(Object(N.a)(r),"fetchVideos",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return fetch("/wp-admin/admin-ajax.php",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded","Cache-Control":"no-cache"},body:new URLSearchParams({action:"presto_fetch_videos",search:e})}).then((function(e){return e.json()})).then((function(e){return e.data||[]}))})),Object(l.a)(Object(N.a)(r),"fetchVideo",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e?fetch("/wp-admin/admin-ajax.php",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded","Cache-Control":"no-cache"},body:new URLSearchParams({action:"presto_fetch_videos",post_id:e})}).then((function(e){return e.json()})).then((function(e){return e.data||[]})):[]})),Object(l.a)(Object(N.a)(r),"loadVideos",function(){var e=Object(d.a)(v.a.mark((function e(t){var n,o,a,c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=z({searchTerm:"",postId:""},t),e.next=3,Promise.all([r.fetchVideo(t.postId),r.fetchVideos(t.searchTerm)]);case 3:return n=e.sent,o=Object(h.a)(n,2),a=o[0],c=o[1],a[0]&&!c.find((function(e){return e.ID===a[0].ID}))&&c.push(a[0]),c=c.map((function(e){return{label:e.post_title||F("Untitled","presto-player"),value:e.ID}})),r.setState({videos:c}),e.abrupt("return",c);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Object(l.a)(Object(N.a)(r),"_onChange",(function(e){r.props._onChange(r.props.name,e.value)})),Object(l.a)(Object(N.a)(r),"_onEditVideoClick",(function(){var e=r.props.value;e&&window.open("/wp-admin/post.php?post=".concat(e,"&action=edit"),"_blank").focus()})),Object(l.a)(Object(N.a)(r),"_onCreateVideoClick",(function(){window.open("/wp-admin/post-new.php?post_type=pp_video_block","_blank").focus()})),Object(l.a)(Object(N.a)(r),"currentVideoLabel",(function(){if(!r.state.videos)return"";var e=(r.state.videos||[]).find((function(e){return e.value===parseInt(r.props.value)}));return e?e.label:""})),r.state={videos:[]};return r.debouncedLoadVideos=B()((function(e){return r.loadVideos({searchTerm:e})}),500,{leading:!0}),r}return Object(c.a)(n,[{key:"render",value:function(){var e=this;return f.a.createElement("div",{className:"presto-player-divi-editor"},f.a.createElement("ul",{className:"presto-player-divi-editor__inputs"},f.a.createElement("li",null,f.a.createElement(Q,{container:window.parent.document.body},f.a.createElement(A.a,{id:"prpd_video_selector-".concat(this.props.name),className:"prpd_video_selector",cacheOptions:!0,defaultOptions:!0,name:this.props.name,value:{value:this.props.value,label:this.currentVideoLabel()},onChange:this._onChange,loadOptions:function(t){return e.debouncedLoadVideos(t)}}))),f.a.createElement("li",null,f.a.createElement("label",null,F("Video Options","presto-player")),f.a.createElement("button",{type:"button",onClick:this._onEditVideoClick},F("Edit Video","presto-player"))),f.a.createElement("li",null,f.a.createElement("label",null,F("New Video","presto-player")),f.a.createElement("button",{type:"button",onClick:this._onCreateVideoClick},F("Create Video","presto-player")))))}}]),n}(p.Component);Object(l.a)(Z,"slug","prpl_video_selector");var $=[Z];o()(window).on("et_builder_api_ready",(function(e,t){t.registerModules(L),t.registerModalFields($)}))}},[[39,1,2]]]);
//# sourceMappingURL=admin-f822d432.js.map