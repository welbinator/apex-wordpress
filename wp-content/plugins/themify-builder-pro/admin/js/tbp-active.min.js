'use strict';(function(g,c){function r(e){return!("advanced-posts"===e&&"archive"===tbp_local.template||"advanced-products"===e&&"product_archive"===tbp_local.template)}Themify.LoadCss(tbp_local.cssUrl,tbp_local.v);window.top.Themify.LoadCss(tbp_local.cssUrl,tbp_local.v);tbp_local.cssUrl=null;"undefined"!==typeof tbp_local&&tbp_local.template&&(document.body.className+=" tbp_template_type_"+tbp_local.template,window.top.Themify.body.one("themify_builder_ready",function(e){setTimeout(function(){window.top.Themify.body[0].className+=
" tbp_template_type_"+tbp_local.template},1E3)}));let n=null;const v=function(e,a){g(".builder-posts-wrap > .themify_builder_slider",e).each(function(){this.swiper.destroy();g(this).find(".post").first().prependTo(g(this).closest(".builder-posts-wrap")).siblings().remove()});var d=e.getElementsByClassName("tbp_advanchd_archive_wrap")[0],b=-1!==a.get("mod_name").indexOf("product")?"_product":"";const k="tbp_edit"+b+"_archive",l="tbp_edit"+b+"_single";b=["order","orderby","offset","meta_key"];const p=
a.get("element_id"),q=g.extend(!0,{},a.get("mod_settings"));d.classList.add("themify_builder_content");d.classList.add("themify_builder_content-"+p);d.classList.add("themify_builder");d.setAttribute("id","themify_builder_content-"+p);d.setAttribute("data-postid",p);d=q.builder_content;let m=g("."+k);"string"===typeof d&&(d=JSON.parse(d));n={aap:!0};!0===r(a.attributes.mod_name)&&(b.push("terms"),b.push("term_type"),b.push("tax"),b.push("post_type"));for(let h=b.length-1;-1<h;--h)void 0!==q[b[h]]&&
""!==q[b[h]]&&(n[b[h]]=q[b[h]]);c.Forms.LayoutPart.cache[p]=d;c.activeModel=c.ActionBar.hoverCid=d=null;document.body.className+=" tbp_app_is_edit tbp_module_"+a.get("mod_name");window.top.document.body.className+=" tbp_app_is_edit tbp_module_"+a.get("mod_name");m=m.add(g("."+k,window.top.document));for(b=m.length-1;-1<b;--b)m[b].classList.remove(k),m[b].classList.add(l);g(e).one("tb_layout_part_before_init",function(){const h=g(this).find(".tb_toolbar_save"),t=g(this).find(".tb_toolbar_close_btn");
h.on("click",function(f){f.preventDefault();f.stopImmediatePropagation();if(null!==c.activeModel||0<ThemifyBuilderCommon.Lightbox.$lightbox.length&&ThemifyBuilderCommon.Lightbox.$lightbox[0].classList.contains("tb_custom_css_lightbox"))f=ThemifyBuilderCommon.Lightbox.$lightbox[0].getElementsByClassName("builder_save_button")[0],void 0!==f&&f.click();f=a.get("mod_settings");f.builder_content=c.Utils.clear(c.Mixins.Builder.toJSON(c.Instances.Builder[c.builderIndex].el));a.set(f,{silent:!0});ThemifyBuilderCommon.showLoader("show");
setTimeout(function(){ThemifyBuilderCommon.showLoader("hide");c.Forms.LayoutPart.options=null;c.Forms.LayoutPart.isSaved=!0},100)});t.on("click",function(f){f.preventDefault();f.stopImmediatePropagation();const u=!0===c.Forms.LayoutPart.isSaved;n=null;c.Forms.LayoutPart.close(f);if(!0===u||0===c.builderIndex){g(this).off("click");h.off("click");delete c.Forms.LayoutPart.cache[p];c.activeModel=c.ActionBar.hoverCid=null;document.body.classList.remove("tbp_app_is_edit","tbp_module_"+a.get("mod_name"));
window.top.document.body.classList.remove("tbp_app_is_edit","tbp_module_"+a.get("mod_name"));for(f=m.length-1;-1<f;--f)m[f].classList.add(k),m[f].classList.remove(l);!0===u&&(ThemifyBuilderCommon.showLoader("show"),a.trigger("custom:preview:refresh",a.get("mod_settings")),setTimeout(function(){c.ActionBar.hoverCid=null;ThemifyBuilderCommon.showLoader("hide")},220))}});g(".tb_overlay").first().one("dblclick",function(f){f.preventDefault();f.stopImmediatePropagation();c.Forms.LayoutPart.options=null;
c.Forms.LayoutPart.isSaved=!0;h.triggerHandler("click");t.triggerHandler("click")})})};c.Constructor.advanced_posts_query={render:function(e,a){return!0===r("advanced-posts")?a.query_posts.render({type:"query_posts",id:"post_type",tax_id:"tax",term_id:"terms",slug_id:"slug",wrap_class:"tbp_app_post_query",query_filter:!0},a):document.createDocumentFragment()}};c.Constructor.advanced_products_query={render:function(e,a){return!0===r("advanced-products")?(a.values.query_type&&("tag"===a.values.query_type?
(a.values.query_type="product_tag",a.values.product_tag_terms=a.values.tag_products):"category"===a.values.query_type&&(a.values.query_type="product_cat",a.values.product_cat_terms=a.values.category_products)),a.values.post_type="product",a.create([{type:"query_posts",id:"post_type",tax_id:"query_type",term_id:"#tmp_id#_terms",query_filter:!0}])):document.createDocumentFragment()}};c.Constructor.tbp_advanched_layout={render:function(e,a){const d=document.createDocumentFragment();if("visual"===c.mode){var b=
document.createElement("a");const k=function(l){l.stopPropagation();l.preventDefault();this.removeEventListener("click",k,{once:!0});const p=c.activeModel.cid;ThemifyConstructor.saveComponent();this.className+=" tb_edit";c.Models.Registry.lookup(p).trigger("edit",l,this)};b.className="tbp_advanched_archive_edit";b.href="#";b.textContent=tbp_local.edit;b.addEventListener("click",k,{once:!0});d.appendChild(b)}else b=document.createElement("div"),b.classList.add("themify-info-link"),b.innerText=tbp_local.edit_backend,
d.appendChild(b);a.values[e.id]&&(a.values[e.id]=JSON.stringify(a.values[e.id]));d.appendChild(a.hidden.render(e,a));return d}};c.Constructor.fallback={render:function(e,a){return a.create([{id:"fallback_s",type:"toggle_switch",label:"fall_b",options:{on:{name:"yes",value:"en"},off:{name:"no",value:"dis"}},binding:{checked:{show:["fallback_i"]},not_checked:{hide:["fallback_i"]}}},{id:"fallback_i",type:"image",wrap_class:"pushed","class":"xlarge"}])}};c.Constructor.tbp_custom_css={render:function(e,
a){return a.create([{id:"css",type:"custom_css"},{type:"custom_css_id"}])}};"visual"===c.mode&&(void 0!==tbp_local.id&&g.ajaxPrefilter(function(e,a,d){if(a.data&&("tb_render_element"===a.data.action||"tb_load_module_partial"===a.data.action)){e.data+="&pageId="+tbp_local.id;a=null;if(null!==n)for(let b in n)"tax"===b?a=n[b]:e.data+="&"+b+"="+n[b];null===a&&(a=tbp_local.type);e.data+="&type="+a}}),Themify.body.on("tb_edit_acf-repeater tb_edit_advanced-posts tb_edit_advanced-products",function(e,a,
d,b){if(!c.Forms.LayoutPart.id&&a&&("dblclick"===a.type||a.target.classList.contains("tb_edit")))return null!==c.activeModel&&g(".builder_save_button",ThemifyBuilderCommon.Lightbox.$lightbox[0]).click(),v(d,b),!0}));g(document).on("tb_editing_module",function(e){let a=Object.assign({},themifyBuilder.DynamicQuery);g(ThemifyBuilderCommon.Lightbox.$lightbox[0]).find('.tb_field[data-type="query_posts"]').each(function(){var d=g(this);if(!d.prev(".tb_field.tbpdq").length){var b=d.find(".tb_search_input.tb_lb_option:first").prop("id");
a[0].binding={off:{show:[b]},not_empty:{hide:[b]}};a=ThemifyConstructor.create(a);"archive"!==tbp_local.template&&"product_archive"!==tbp_local.template&&a.querySelector('option[value="on"]').setAttribute("disabled","disabled");g(a).insertBefore(d);d=ThemifyBuilderCommon.Lightbox.$lightbox[0].querySelector("#tbpdq");b=function(){let k=this.value;ThemifyBuilderCommon.Lightbox.$lightbox[0].querySelectorAll(".tbpdq_settings").forEach(function(l){l.style.display=l.classList.contains("tbpdq_settings_"+
k)?"block":"none"})};d.addEventListener("change",b);b.call(d)}})})})(jQuery,tb_app);
